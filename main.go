package main

import (
	"AADDecryptor/pkg/aad"
	"AADDecryptor/pkg/cli"
	"AADDecryptor/pkg/utils"
	"fmt"
)

func main() {
	logoPrint()
	opt := cli.ParseParameter()

	defFiles := utils.FindDefFiles(opt.DefFiles)
	if len(defFiles) == 0 {
		fmt.Println("[-] Def files not found!")
		return
	}

	aad.DecryptDefFiles(opt, defFiles)
}

func logoPrint() {
	logoHex := "5f5f5f5f5f5f2020202020202020202020202020202020202020202020202020205f202020202020202020202020200a7c20205f20205c202020204141442042726f6b6572506c7567696e20202020207c207c2020202020202020202020200a7c207c207c207c5f5f5f20205f5f5f205f205f5f205f2020205f205f205f5f207c207c5f205f5f5f20205f205f5f200a7c207c207c202f205f205c2f205f5f7c20275f5f7c207c207c207c20275f205c7c205f5f2f205f205c7c20275f5f7c0a7c207c2f202f20205f5f2f20285f5f7c207c20207c207c5f7c207c207c5f29207c207c7c20285f29207c207c2020200a7c5f5f5f2f205c5f5f5f7c5c5f5f5f7c5f7c2020205c5f5f2c207c202e5f5f2f205c5f5f5c5f5f5f2f7c5f7c2020200a202020202020202020202020202020202020202020205f5f2f207c207c2020202020202020202020202020202020200a2020202020202020202020202020202020202020207c5f5f5f2f7c5f7c20202020202076312e302e3020202020202020"
	logo := utils.HexToBytes(logoHex)
	fmt.Printf("%s\n\n", logo)
}
